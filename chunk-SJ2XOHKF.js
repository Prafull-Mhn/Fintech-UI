import{a as j}from"./chunk-NBLQEEMX.js";import{b as W}from"./chunk-EM64PZW2.js";import{a as V}from"./chunk-G7UHNQID.js";import"./chunk-5GEWOZRP.js";import{a as x}from"./chunk-ME7WQYDW.js";import{c as F,i as O}from"./chunk-62M4YNQY.js";import{N as q}from"./chunk-XPN3NBIY.js";import"./chunk-CARY4E7O.js";import"./chunk-FXOCLQ3T.js";import{a as A}from"./chunk-EBTZRFCE.js";import{Ab as l,Bb as o,Ca as f,Cb as N,Da as g,Gb as _,Jb as m,Lb as r,Nc as E,Ub as h,Wb as S,Xa as s,Ya as p,Yc as k,ac as M,bc as T,dc as C,dd as I,nb as b,pb as c,ta as v,vb as u,xb as y,yb as w,yc as P,zb as D}from"./chunk-IZBYZ66D.js";var R=i=>({"ti-btn-primary":i});function U(i,d){if(i&1){let e=_();l(0,"app-data-grid",9),m("buttonAction",function(a){f(e);let n=r(2);return g(n.printReceipt(a))}),o()}if(i&2){let e=r(2);c("tableDataSet",e.rechargeDetails)("tableConfig",e.tableConfig)("tableWidth",100)("formName","Mobile Recharges Details")}}function z(i,d){if(i&1&&(N(0,"app-dynamic-form",7),b(1,U,1,4,"app-data-grid",8)),i&2){let e=r();c("formConfig",e.searchConfig)("formName","Search")("columnCount",3),s(),u(1,e.rechargeDetails.length>0?1:-1)}}function H(i,d){if(i&1){let e=_();l(0,"a",6),m("click",function(){let a=f(e).$implicit,n=r(3);return g(n.selectPlanType(a))}),h(1),o()}if(i&2){let e=d.$implicit,t=r(3);c("ngClass",C(2,R,t.selectedPlan===e)),s(),S(" ",e," ")}}function B(i,d){if(i&1){let e=_();l(0,"app-data-grid",9),m("buttonAction",function(a){f(e);let n=r(3);return g(n.doRecharge(a))}),o()}if(i&2){let e=r(3);c("tableDataSet",e.plans)("tableConfig",e.mobileRechargeConfig)("tableWidth",100)("formName","Mobile Recharges Plans")}}function $(i,d){i&1&&(l(0,"div",15)(1,"h3"),h(2,"No plans found."),o()())}function G(i,d){if(i&1&&(l(0,"div",11)(1,"div",1)(2,"div",12)(3,"div",3)(4,"div")(5,"h6",13),h(6,"Plans"),o()(),l(7,"div",4)(8,"nav",5),w(9,H,2,4,"a",14,y),o()()()()(),b(11,B,1,4,"app-data-grid",8)(12,$,3,0),o()),i&2){let e=r(2);s(9),D(e.planTypes),s(2),u(11,e.plans.length>0?11:12)}}function J(i,d){if(i&1){let e=_();l(0,"app-dynamic-form",10),m("action",function(a){f(e);let n=r();return g(n.getRechargeDetails(a.form))}),o(),b(1,G,13,1,"div",11)}if(i&2){let e=r();c("formConfig",e.formConfig)("formName","Mobile Recharge")("columnCount",3),s(),u(1,e.planTypes.length>0?1:-1)}}var se=(()=>{class i{constructor(e,t,a,n,L){this.apiService=e,this.dialog=t,this.utilityService=a,this.cdr=n,this.messageNotificationService=L,this.tableConfig={tableHeading:"Service Details",columns:[{name:"ReferenceID",field:"referenceID",width:"120"},{name:"Mobile Number",field:"canumber",width:"120"},{name:"Recharge Date",field:"transactionDate",width:"120",type:"date"},{name:"Status",field:"status",width:"100",type:"highlight"},{name:"Price",field:"amount",width:"120"}],config:{sorting:{column:"price",order:"desc"},pageSizeOptions:[5,10],pageSize:7},handlers:[{text:"Print Receipt",title:"Print Receipt",type:"print",color:"primary"}],isRowClickable:!1,isSearchable:!0},this.mobileRechargeConfig={tableHeading:"Recharge Details",columns:[{name:"Description",field:"desc",width:"350"},{name:"Validity",field:"validity",width:"120"},{name:"Price",field:"rs",width:"120",type:"rs"}],config:{sorting:{column:"price",order:"desc"},pageSizeOptions:[5,10],pageSize:7},isRowClickable:!1,isSearchable:!0},this.formConfig={fields:[{type:"text",label:"Mobile Number",placeholder:"Enter Mobile Number",class:"form-control",id:"number",validators:[{isRequired:!0,message:"Mobile Number is required"}]},{type:"dropdownWithID",id:"operatorId",label:"Operator List",options:[],class:"form-control",validators:[{isRequired:!0,message:"Operator is required"}]}]},this.searchConfig={fields:[{type:"text",label:"Mobile Number",placeholder:"Enter Mobile Number",class:"form-control",id:"number",validators:[{isRequired:!1}]},{type:"dropdownWithID",id:"operator",label:"Operator List",options:[],class:"form-control",validators:[{isRequired:!1}]},{type:"dropdown",id:"circle",label:"Circle List",options:[{value:"Delhi NCR",label:"Delhi NCR"},{value:"UP West",label:"UP West"},{value:"UP North",label:"UP North"}],class:"form-control",validators:[{isRequired:!1}]},{type:"text",id:"rechargeAmount",label:"Recharge Amount",placeholder:"Enter Recharge Amount",class:"form-control",validators:[{isRequired:!1}]}]},this.planTypes=[],this.selectedPlan="",this.selectedTab="Mobile Recharge",this.plans=[],this.searchText=""}ngOnInit(){this.utilityService.operatorList$.subscribe(()=>{let e=this.utilityService.filterByCategory("Prepaid");this.formConfig.fields[1].options=e,this.searchConfig.fields[1].options=e})}getRechargeDetails(e){e.type="Mobile",this.apiService.checkCircleDetails(e).subscribe({next:t=>{t.message==="Fetch Successful"&&(e.circle=t.info.circle,e.op=t.info.operator,this.browsePlan(e))},error:t=>{console.error("Error fetching data:",t)}})}browsePlan(e){this.apiService.browsePlan(e).subscribe({next:t=>{this.allPlans=t.info,this.planTypes=Object.keys(this.allPlans),this.selectedPlan=this.planTypes[1],this.plans=this.allPlans[this.selectedPlan],this.selectionDetailsRecharge=e,this.selectedTab="Mobile Recharge"},error:t=>{console.error("Error fetching data:",t)}})}selectPlanType(e){this.plans=[],this.selectedPlan=e,setTimeout(()=>{this.plans=this.allPlans[e]||[],this.cdr.detectChanges()},0)}doRecharge(e){this.dialog.open(W,{data:"Confirmation"}).afterClosed().subscribe(a=>{a==="submit"&&this.doPayment(e)})}doPayment(e){this.selectionDetailsRecharge.amount=e.rs,this.selectionDetailsRecharge.canumber=this.selectionDetailsRecharge.number,this.apiService.doRecharge(this.selectionDetailsRecharge).subscribe({next:t=>{t.status?this.messageNotificationService.success(t.message,"success",5e3):this.messageNotificationService.error(t.message,"error",5e3)},error:t=>{console.error("Error fetching data:",t)}})}printReceipt(e){e.rechargeType="Mobile",this.dialog.open(j,{data:e})}getTransactionDetails(){let e={transactionType:"MOBILE_RECHARGE"};this.apiService.getTransactionDetails(e).subscribe({next:t=>{t[0].status?this.rechargeDetails=t:this.messageNotificationService.error(t.message,"error",5e3)},error:t=>{console.error("Error fetching data:",t)}})}tabChangeEvent(e){switch(this.selectedTab=e,e){case"Recharge Details":this.getTransactionDetails();break;case"Mobile Recharge":break}}static{this.\u0275fac=function(t){return new(t||i)(p(x),p(F),p(V),p(P),p(A))}}static{this.\u0275cmp=v({type:i,selectors:[["app-new-mobile-recharge"]],standalone:!0,features:[M([x]),T],decls:12,vars:7,consts:[[1,"grid","grid-cols-12","gap-6"],[1,"xl:col-span-12","col-span-12"],[1,"box","box-body","!p-0"],[1,"md:flex","px-4","py-6","items-center","justify-between"],[1,"mt-2","md:mt-0"],[1,"-mb-0.5","sm:flex","sm:space-x-6","rtl:space-x-reverse","flex-wrap"],[1,"w-full","flex","sm:w-auto","hs-tab-active:font-semibold","hs-tab-active:text-primary","hs-tab-active:bg-primary/10","rounded-md","py-2","px-3","text-sm","cursor-pointer",3,"click","ngClass"],[3,"formConfig","formName","columnCount"],[3,"tableDataSet","tableConfig","tableWidth","formName"],[3,"buttonAction","tableDataSet","tableConfig","tableWidth","formName"],[3,"action","formConfig","formName","columnCount"],[1,"box"],[1,"box-body","!p-0"],[1,"font-semibold","mb-0","text-[1rem]"],[1,"w-full","flex","sm:w-auto","hs-tab-active:font-semibold","hs-tab-active:text-primary","hs-tab-active:bg-primary/10","rounded-md","py-2","px-3","text-sm","cursor-pointer",3,"ngClass"],[1,"text-center"]],template:function(t,a){t&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"nav",5)(6,"a",6),m("click",function(){return a.tabChangeEvent("Recharge Details")}),h(7," Recharge Details "),o(),l(8,"a",6),m("click",function(){return a.tabChangeEvent("Mobile Recharge"),a.plans=[],a.planTypes=[]}),h(9," Mobile Recharge "),o()()()()(),b(10,z,2,4)(11,J,2,4),o()()),t&2&&(s(6),c("ngClass",C(3,R,a.selectedTab==="Recharge Details")),s(2),c("ngClass",C(5,R,a.selectedTab==="Mobile Recharge")),s(2),u(10,a.selectedTab==="Recharge Details"?10:11))},dependencies:[O,q,k,E,I]})}}return i})();export{se as NewMobileRechargeComponent};
