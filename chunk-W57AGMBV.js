import{a as G,b as V}from"./chunk-RFCQFOQF.js";import{a as I}from"./chunk-WZR7FGU4.js";import"./chunk-2HWEYSZF.js";import{a as p}from"./chunk-TTTGN722.js";import{c as B,i as F}from"./chunk-NJAA5WMU.js";import{H as k}from"./chunk-VUNI6NKD.js";import"./chunk-CARY4E7O.js";import"./chunk-WFQ5CS6Y.js";import{a as M}from"./chunk-SWM7WQST.js";import{Ab as m,Bb as s,Ca as u,Cb as _,Da as h,Gb as y,Jb as d,Lb as c,Nc as x,Ub as C,Wc as w,Xa as o,Ya as n,a as f,ac as N,bc as R,bd as H,dc as D,nb as g,pb as a,ta as v,vb as b,yc as T}from"./chunk-NVK54OB3.js";var E=i=>({"ti-btn-primary":i});function A(i,S){if(i&1&&_(0,"app-dynamic-form",7)(1,"app-data-grid",8),i&2){let e=c();a("formConfig",e.formConfig)("formName","Search")("columnCount",3),o(),a("tableDataSet",e.rechargeDetails)("tableConfig",e.tableConfig)("tableWidth",100)("formName","DTH Recharges Details")}}function P(i,S){if(i&1){let e=y();m(0,"app-show-details",11),d("action",function(){u(e);let r=c(2);return h(r.doRecharge())}),s()}if(i&2){let e=c(2);a("formValue",e.dthInfo[0])("formName","Pay DTH Bill")("displayFields",e.DTHShowFormConfig)}}function O(i,S){if(i&1){let e=y();m(0,"app-dynamic-form",9),d("action",function(r){u(e);let l=c();return h(l.getRechargeDetails(r.form))}),s(),g(1,P,1,3,"app-show-details",10)}if(i&2){let e=c();a("formConfig",e.dthFormConfig)("formName","DTH Recharge")("columnCount",3),o(),b(1,e.dthInfo.length>0?1:-1)}}var te=(()=>{class i{constructor(e,t,r,l,q){this.apiService=e,this.utilityService=t,this.dialog=r,this.cdr=l,this.messageNotificationService=q,this.rechargeDetails=[{customerNumber:"9876543210",rechargeDate:"2024-07-27",operator:"Airtel",price:199,description:"1 GB data per day, unlimited calls",validity:28},{customerNumber:"8765432109",rechargeDate:"2024-07-26",operator:"Jio",price:399,description:"2 GB data per day, unlimited calls, 100 SMS",validity:56},{customerNumber:"7654321098",rechargeDate:"2024-07-25",operator:"Vodafone",price:599,description:"3 GB data per day, unlimited calls, 100 SMS, Disney+ Hotstar subscription",validity:84},{customerNumber:"6543210987",rechargeDate:"2024-07-24",operator:"BSNL",price:149,description:"Unlimited calls, 1 GB data, 100 SMS",validity:28},{customerNumber:"5432109876",rechargeDate:"2024-07-23",operator:"Airtel",price:799,description:"2 GB data per day, unlimited calls, 100 SMS, Amazon Prime subscription",validity:84},{customerNumber:"4321098765",rechargeDate:"2024-07-22",operator:"Jio",price:249,description:"1.5 GB data per day, unlimited calls, 100 SMS",validity:56},{customerNumber:"3210987654",rechargeDate:"2024-07-21",operator:"Vodafone",price:449,description:"2 GB data per day, unlimited calls, 100 SMS",validity:84},{customerNumber:"2109876543",rechargeDate:"2024-07-20",operator:"BSNL",price:199,description:"1 GB data per day, unlimited calls",validity:28},{customerNumber:"1098765432",rechargeDate:"2024-07-19",operator:"Airtel",price:349,description:"1.5 GB data per day, unlimited calls, 100 SMS",validity:56},{customerNumber:"0987654321",rechargeDate:"2024-07-18",operator:"Jio",price:699,description:"3 GB data per day, unlimited calls, 100 SMS, Netflix subscription",validity:84},{customerNumber:"9988776655",rechargeDate:"2024-07-17",operator:"Vodafone",price:179,description:"Unlimited calls, 1 GB data, 100 SMS",validity:28},{customerNumber:"8899776655",rechargeDate:"2024-07-16",operator:"BSNL",price:299,description:"1.5 GB data per day, unlimited calls, 100 SMS",validity:56}],this.tableConfig={tableHeading:"Service Details",columns:[{name:"Customer Number",field:"customerNumber",width:"120"},{name:"Operator",field:"operator",width:"120"},{name:"Recharge Date",field:"rechargeDate",width:"120"},{name:"Validity",field:"validity",width:"120"},{name:"Description",field:"description",width:"350"},{name:"Price",field:"price",width:"120"}],config:{sorting:{column:"price",order:"desc"},pageSizeOptions:[5,10],pageSize:7},isRowClickable:!1,isSearchable:!0},this.formConfig={fields:[{type:"text",label:"Customer Number",placeholder:"Enter Customer Number",class:"form-control",id:"custNumber",validators:[{isRequired:!1}]},{type:"dropdown",id:"operatorId",label:"Operator List",options:[],class:"form-control",validators:[{isRequired:!1}]},{type:"text",id:"rechargeAmount",label:"Recharge Amount",placeholder:"Enter Recharge Amount",class:"form-control",validators:[{isRequired:!1}]}]},this.dthFormConfig={fields:[{type:"text",label:"Customer Number",placeholder:"Enter Customer Number",class:"form-control",id:"number",validators:[{isRequired:!0,message:"Customer Number is required"}]},{type:"dropdownWithID",id:"operatorId",label:"Operator List",options:[],class:"form-control",validators:[{isRequired:!0,message:"Operator is required"}]}]},this.DTHShowFormConfig={fields:[{key:"customerName",name:"Customer Name"},{key:"Balance",name:"Balance"},{key:"MonthlyRecharge",name:"Monthly Recharge"},{key:"NextRechargeDate",name:"Next Recharge Date"},{key:"status",name:"Status"},{key:"planname",name:"Plan"}]},this.selectedTab="DTH Recharge",this.dthInfo=[]}ngOnInit(){this.utilityService.operatorList$.subscribe(()=>{let e=this.utilityService.filterByCategory("DTH");this.formConfig.fields[1].options=e,this.dthFormConfig.fields[1].options=e})}getRechargeDetails(e){e.type="DTH",this.apiService.checkCircleDetails(e).subscribe({next:t=>{t.status?(e.circle=t.info.circle,e.op=t.info.operator,e.canumber=e.number,this.getDTHInfo(e)):this.messageNotificationService.error(t.message,"error")},error:t=>{this.messageNotificationService.error("Unable to Find DTH Info","error"),console.error("Error fetching data:",t)}})}getDTHInfo(e){this.dthInfo=[],this.apiService.getDTHInfo(e).subscribe({next:t=>{t.status?(e.referenceid=this.generateUniqueReferenceID().toString(),e.amount=t.info[0].MonthlyRecharge,this.dthInfo.push(f(f({},t.info[0]),e))):this.messageNotificationService.error(t.message,"error")},error:t=>{this.messageNotificationService.error("Unable to Find DTH Info","error"),console.error("Error fetching data:",t)}})}generateUniqueReferenceID(){let e=Math.floor(Math.random()*1e6);return new Date().getTime()+e}doRecharge(){this.dialog.open(V,{data:"Confirmation"}).afterClosed().subscribe(t=>{t==="submit"&&this.doPayment()})}doPayment(){this.apiService.doRecharge(this.dthInfo[0]).subscribe({next:e=>{e.status?this.messageNotificationService.success(e.message,"success",5e3):this.messageNotificationService.error(e.message,"error",5e3)},error:e=>{console.error("Error fetching data:",e)}})}static{this.\u0275fac=function(t){return new(t||i)(n(p),n(I),n(B),n(T),n(M))}}static{this.\u0275cmp=v({type:i,selectors:[["app-dth-recharge"]],standalone:!0,features:[N([p]),R],decls:12,vars:7,consts:[[1,"grid","grid-cols-12","gap-6"],[1,"xl:col-span-12","col-span-12"],[1,"box","box-body","!p-0"],[1,"md:flex","px-4","py-6","items-center","justify-between"],[1,"mt-2","md:mt-0"],[1,"-mb-0.5","sm:flex","sm:space-x-6","rtl:space-x-reverse","flex-wrap"],[1,"w-full","flex","sm:w-auto","hs-tab-active:font-semibold","hs-tab-active:text-primary","hs-tab-active:bg-primary/10","rounded-md","py-2","px-3","text-sm","cursor-pointer",3,"click","ngClass"],[3,"formConfig","formName","columnCount"],[3,"tableDataSet","tableConfig","tableWidth","formName"],[3,"action","formConfig","formName","columnCount"],[3,"formValue","formName","displayFields"],[3,"action","formValue","formName","displayFields"]],template:function(t,r){t&1&&(m(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"nav",5)(6,"a",6),d("click",function(){return r.selectedTab="Recharge Details"}),C(7," Recharge Details "),s(),m(8,"a",6),d("click",function(){return r.selectedTab="DTH Recharge",r.dthInfo=[]}),C(9," DTH Recharge "),s()()()()(),g(10,A,2,7)(11,O,2,4),s()()),t&2&&(o(6),a("ngClass",D(3,E,r.selectedTab==="Recharge Details")),o(2),a("ngClass",D(5,E,r.selectedTab==="DTH Recharge")),o(2),b(10,r.selectedTab==="Recharge Details"?10:11))},dependencies:[F,k,w,x,H,G]})}}return i})();export{te as DTHRechargeComponent};
